"use strict";(globalThis.webpackChunkwebsite=globalThis.webpackChunkwebsite||[]).push([[7610],{6593(e,t,a){a.r(t),a.d(t,{assets:()=>l,contentTitle:()=>c,default:()=>p,frontMatter:()=>r,metadata:()=>n,toc:()=>o});const n=JSON.parse('{"id":"getting-started/first-test","title":"Your First Test","description":"Learn the anatomy of a DLest test and write your first analytics test.","source":"@site/docs/getting-started/first-test.md","sourceDirName":"getting-started","slug":"/getting-started/first-test","permalink":"/dlest/getting-started/first-test","draft":false,"unlisted":false,"editUrl":"https://github.com/metricasboss/dlest/tree/main/website/docs/getting-started/first-test.md","tags":[],"version":"current","frontMatter":{},"sidebar":"tutorialSidebar","previous":{"title":"Quick Start","permalink":"/dlest/getting-started/quick-start"},"next":{"title":"Writing Tests","permalink":"/dlest/guides/writing-tests"}}');var s=a(4848),i=a(8453);const r={},c="Your First Test",l={},o=[{value:"Test Structure",id:"test-structure",level:2},{value:"Test Fixtures",id:"test-fixtures",level:2},{value:"<code>page</code> - Browser Control",id:"page---browser-control",level:3},{value:"<code>dataLayer</code> - Analytics Tracking",id:"datalayer---analytics-tracking",level:3},{value:"<code>network</code> - Network Requests",id:"network---network-requests",level:3},{value:"Writing Effective Tests",id:"writing-effective-tests",level:2},{value:"1. Use Descriptive Names",id:"1-use-descriptive-names",level:3},{value:"2. Test User Flows",id:"2-test-user-flows",level:3},{value:"3. Use Jest Matchers",id:"3-use-jest-matchers",level:3},{value:"4. Handle Async Events",id:"4-handle-async-events",level:3},{value:"5. Group Related Tests",id:"5-group-related-tests",level:3},{value:"Common Patterns",id:"common-patterns",level:2},{value:"Testing Forms",id:"testing-forms",level:3},{value:"Testing Navigation",id:"testing-navigation",level:3},{value:"Testing Clicks",id:"testing-clicks",level:3},{value:"Next Steps",id:"next-steps",level:2},{value:"Tips",id:"tips",level:2}];function d(e){const t={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,i.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(t.header,{children:(0,s.jsx)(t.h1,{id:"your-first-test",children:"Your First Test"})}),"\n",(0,s.jsx)(t.p,{children:"Learn the anatomy of a DLest test and write your first analytics test."}),"\n",(0,s.jsx)(t.h2,{id:"test-structure",children:"Test Structure"}),"\n",(0,s.jsx)(t.p,{children:"A DLest test has three main parts:"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-javascript",children:"const { test, expect } = require('dlest');\n\n// 1. Test definition\ntest('descriptive test name', async ({ page, dataLayer }) => {\n  // 2. Browser interactions\n  await page.goto('http://localhost:3000/product');\n  await page.click('#add-to-cart');\n\n  // 3. Assertions\n  await expect(dataLayer).toHaveEvent('add_to_cart');\n});\n"})}),"\n",(0,s.jsx)(t.h2,{id:"test-fixtures",children:"Test Fixtures"}),"\n",(0,s.jsx)(t.p,{children:"DLest provides two main fixtures in every test:"}),"\n",(0,s.jsxs)(t.h3,{id:"page---browser-control",children:[(0,s.jsx)(t.code,{children:"page"})," - Browser Control"]}),"\n",(0,s.jsxs)(t.p,{children:["The ",(0,s.jsx)(t.code,{children:"page"})," fixture is a Playwright Page object for browser automation:"]}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-javascript",children:"test('example', async ({ page }) => {\n  // Navigate to a URL\n  await page.goto('https://example.com');\n\n  // Click elements\n  await page.click('#button');\n\n  // Fill forms\n  await page.fill('#email', 'test@example.com');\n\n  // Wait for elements\n  await page.waitForSelector('.product');\n\n  // Type text\n  await page.type('#search', 'laptop');\n\n  // Press keys\n  await page.press('#input', 'Enter');\n});\n"})}),"\n",(0,s.jsx)(t.p,{children:(0,s.jsx)(t.a,{href:"https://playwright.dev/docs/api/class-page",children:"See full Playwright Page API \u2192"})}),"\n",(0,s.jsxs)(t.h3,{id:"datalayer---analytics-tracking",children:[(0,s.jsx)(t.code,{children:"dataLayer"})," - Analytics Tracking"]}),"\n",(0,s.jsxs)(t.p,{children:["The ",(0,s.jsx)(t.code,{children:"dataLayer"})," fixture captures all analytics events:"]}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-javascript",children:"test('example', async ({ page, dataLayer }) => {\n  await page.goto('http://localhost:3000');\n\n  // Check if event exists\n  await expect(dataLayer).toHaveEvent('page_view');\n\n  // Check event with specific data\n  await expect(dataLayer).toHaveEvent('purchase', {\n    value: 99.99,\n    currency: 'USD'\n  });\n\n  // Count events\n  await expect(dataLayer).toHaveEventCount('page_view', 1);\n\n  // Verify sequence\n  await expect(dataLayer).toHaveEventSequence([\n    'page_view',\n    'add_to_cart',\n    'purchase'\n  ]);\n});\n"})}),"\n",(0,s.jsx)(t.p,{children:(0,s.jsx)(t.a,{href:"/api/matchers",children:"See all matchers \u2192"})}),"\n",(0,s.jsxs)(t.h3,{id:"network---network-requests",children:[(0,s.jsx)(t.code,{children:"network"})," - Network Requests"]}),"\n",(0,s.jsxs)(t.p,{children:["The ",(0,s.jsx)(t.code,{children:"network"})," fixture captures HTTP requests (useful for GA4/GTM validation):"]}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-javascript",children:"test('GA4 tracking', async ({ page, network }) => {\n  await page.goto('http://localhost:3000');\n\n  await expect(network).toHaveRequest({\n    url: 'https://www.google-analytics.com/g/collect',\n    params: {\n      en: 'page_view', // Event name\n      ep: expect.objectContaining({\n        page_title: 'Home'\n      })\n    }\n  });\n});\n"})}),"\n",(0,s.jsx)(t.p,{children:(0,s.jsx)(t.a,{href:"/guides/network-validation",children:"Learn more about network validation \u2192"})}),"\n",(0,s.jsx)(t.h2,{id:"writing-effective-tests",children:"Writing Effective Tests"}),"\n",(0,s.jsx)(t.h3,{id:"1-use-descriptive-names",children:"1. Use Descriptive Names"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-javascript",children:"// \u274c Bad - vague\ntest('test 1', async ({ page, dataLayer }) => {\n  // ...\n});\n\n// \u2705 Good - descriptive\ntest('purchase event fires with correct transaction data', async ({ page, dataLayer }) => {\n  // ...\n});\n"})}),"\n",(0,s.jsx)(t.h3,{id:"2-test-user-flows",children:"2. Test User Flows"}),"\n",(0,s.jsx)(t.p,{children:"Think about the user journey:"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-javascript",children:"test('complete checkout flow', async ({ page, dataLayer }) => {\n  // 1. View product\n  await page.goto('http://localhost:3000/product/123');\n  await expect(dataLayer).toHaveEvent('view_item');\n\n  // 2. Add to cart\n  await page.click('#add-to-cart');\n  await expect(dataLayer).toHaveEvent('add_to_cart');\n\n  // 3. Go to cart\n  await page.click('#view-cart');\n  await expect(dataLayer).toHaveEvent('view_cart');\n\n  // 4. Complete purchase\n  await page.click('#checkout');\n  await expect(dataLayer).toHaveEvent('purchase', {\n    transaction_id: expect.any(String),\n    value: expect.any(Number)\n  });\n\n  // 5. Verify sequence\n  await expect(dataLayer).toHaveEventSequence([\n    'view_item',\n    'add_to_cart',\n    'view_cart',\n    'purchase'\n  ]);\n});\n"})}),"\n",(0,s.jsx)(t.h3,{id:"3-use-jest-matchers",children:"3. Use Jest Matchers"}),"\n",(0,s.jsx)(t.p,{children:"DLest supports Jest's expect helpers:"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-javascript",children:"test('flexible matching', async ({ page, dataLayer }) => {\n  await page.goto('http://localhost:3000');\n\n  await expect(dataLayer).toHaveEvent('purchase', {\n    // Any string\n    transaction_id: expect.any(String),\n\n    // Any number\n    value: expect.any(Number),\n\n    // Exact value\n    currency: 'USD',\n\n    // Array containing\n    items: expect.arrayContaining([\n      expect.objectContaining({\n        item_id: 'prod-123'\n      })\n    ]),\n\n    // Object containing (partial match)\n    user: expect.objectContaining({\n      id: '12345'\n    })\n  });\n});\n"})}),"\n",(0,s.jsx)(t.h3,{id:"4-handle-async-events",children:"4. Handle Async Events"}),"\n",(0,s.jsx)(t.p,{children:"Some events fire after delays (API calls, animations):"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-javascript",children:"test('async purchase event', async ({ page, dataLayer }) => {\n  await page.click('#checkout');\n\n  // Wait for async operation\n  await page.waitForTimeout(2000);\n\n  // Or wait for specific element\n  await page.waitForSelector('.success-message');\n\n  await expect(dataLayer).toHaveEvent('purchase');\n});\n"})}),"\n",(0,s.jsx)(t.h3,{id:"5-group-related-tests",children:"5. Group Related Tests"}),"\n",(0,s.jsxs)(t.p,{children:["Use ",(0,s.jsx)(t.code,{children:"test.describe"})," to organize tests:"]}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-javascript",children:"test.describe('Product Page Tracking', () => {\n  test('view_item event fires on page load', async ({ page, dataLayer }) => {\n    await page.goto('http://localhost:3000/product/123');\n    await expect(dataLayer).toHaveEvent('view_item');\n  });\n\n  test('add_to_cart event fires on button click', async ({ page, dataLayer }) => {\n    await page.goto('http://localhost:3000/product/123');\n    await page.click('#add-to-cart');\n    await expect(dataLayer).toHaveEvent('add_to_cart');\n  });\n});\n\ntest.describe('Checkout Flow', () => {\n  test('begin_checkout event fires', async ({ page, dataLayer }) => {\n    // ...\n  });\n\n  test('purchase event fires with correct data', async ({ page, dataLayer }) => {\n    // ...\n  });\n});\n"})}),"\n",(0,s.jsx)(t.h2,{id:"common-patterns",children:"Common Patterns"}),"\n",(0,s.jsx)(t.h3,{id:"testing-forms",children:"Testing Forms"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-javascript",children:"test('form submission tracking', async ({ page, dataLayer }) => {\n  await page.goto('http://localhost:3000/contact');\n\n  await page.fill('#name', 'John Doe');\n  await page.fill('#email', 'john@example.com');\n  await page.fill('#message', 'Hello world');\n\n  await page.click('#submit');\n\n  await expect(dataLayer).toHaveEvent('form_submit', {\n    form_name: 'contact',\n    form_destination: 'sales'\n  });\n});\n"})}),"\n",(0,s.jsx)(t.h3,{id:"testing-navigation",children:"Testing Navigation"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-javascript",children:"test('page navigation tracking', async ({ page, dataLayer }) => {\n  // Homepage\n  await page.goto('http://localhost:3000');\n  await expect(dataLayer).toHaveEvent('page_view', {\n    page_path: '/'\n  });\n\n  // Navigate to product\n  await page.click('a[href=\"/products\"]');\n  await expect(dataLayer).toHaveEventCount('page_view', 2);\n});\n"})}),"\n",(0,s.jsx)(t.h3,{id:"testing-clicks",children:"Testing Clicks"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-javascript",children:"test('CTA button click tracking', async ({ page, dataLayer }) => {\n  await page.goto('http://localhost:3000');\n\n  await page.click('#cta-button');\n\n  await expect(dataLayer).toHaveEvent('click', {\n    link_text: 'Get Started',\n    link_url: '/signup'\n  });\n});\n"})}),"\n",(0,s.jsx)(t.h2,{id:"next-steps",children:"Next Steps"}),"\n",(0,s.jsx)(t.p,{children:"Now that you understand test structure:"}),"\n",(0,s.jsxs)(t.ol,{children:["\n",(0,s.jsxs)(t.li,{children:["Learn about all ",(0,s.jsx)(t.a,{href:"/api/matchers",children:"available matchers"})]}),"\n",(0,s.jsxs)(t.li,{children:["Explore ",(0,s.jsx)(t.a,{href:"/guides/templates",children:"test templates"})," for common scenarios"]}),"\n",(0,s.jsxs)(t.li,{children:["See ",(0,s.jsx)(t.a,{href:"/examples/ecommerce",children:"real-world examples"})]}),"\n",(0,s.jsxs)(t.li,{children:["Set up ",(0,s.jsx)(t.a,{href:"/guides/debugging",children:"debugging"})," for troubleshooting"]}),"\n"]}),"\n",(0,s.jsx)(t.h2,{id:"tips",children:"Tips"}),"\n",(0,s.jsxs)(t.ul,{children:["\n",(0,s.jsxs)(t.li,{children:[(0,s.jsx)(t.strong,{children:"Start simple"}),": Test one event at a time"]}),"\n",(0,s.jsxs)(t.li,{children:[(0,s.jsx)(t.strong,{children:"Use verbose mode"}),": ",(0,s.jsx)(t.code,{children:"--verbose"})," helps debug"]}),"\n",(0,s.jsxs)(t.li,{children:[(0,s.jsx)(t.strong,{children:"Watch browser"}),": ",(0,s.jsx)(t.code,{children:"--no-headless"})," shows what's happening"]}),"\n",(0,s.jsxs)(t.li,{children:[(0,s.jsx)(t.strong,{children:"Check timing"}),": Add ",(0,s.jsx)(t.code,{children:"waitForTimeout"})," if events are async"]}),"\n",(0,s.jsxs)(t.li,{children:[(0,s.jsx)(t.strong,{children:"Group tests"}),": Use ",(0,s.jsx)(t.code,{children:"describe"})," blocks for organization"]}),"\n",(0,s.jsxs)(t.li,{children:[(0,s.jsx)(t.strong,{children:"Be specific"}),": Match exact data when possible"]}),"\n",(0,s.jsxs)(t.li,{children:[(0,s.jsx)(t.strong,{children:"Test sequences"}),": Verify complete user flows"]}),"\n"]})]})}function p(e={}){const{wrapper:t}={...(0,i.R)(),...e.components};return t?(0,s.jsx)(t,{...e,children:(0,s.jsx)(d,{...e})}):d(e)}},8453(e,t,a){a.d(t,{R:()=>r,x:()=>c});var n=a(6540);const s={},i=n.createContext(s);function r(e){const t=n.useContext(i);return n.useMemo(function(){return"function"==typeof e?e(t):{...t,...e}},[t,e])}function c(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:r(e.components),n.createElement(i.Provider,{value:t},e.children)}}}]);